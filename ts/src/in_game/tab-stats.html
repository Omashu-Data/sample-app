<!-- Tab de Estadísticas - Diseño Mejorado -->
<div class="stats-container layout-column" style="background: var(--background-primary, #090521); color: var(--text-primary, #fff); padding: var(--spacing-md) var(--spacing-lg); gap: var(--spacing-md);">

  <!-- Encabezado con nombre del jugador y tiempo de partida -->
  <div class="stats-header" style="background: linear-gradient(to right, rgba(19, 11, 55, 0.95), rgba(39, 22, 100, 0.85)); border-radius: var(--border-radius-md); padding: var(--spacing-md); margin-bottom: var(--spacing-sm); box-shadow: var(--shadow-md); border: 1px solid rgba(109, 61, 255, 0.2);">
    <div class="stats-title flex-row align-center justify-between">
      <div>
        <h2 style="color: var(--omashu-purple-light, #bc76ff); text-shadow: 0 0 5px rgba(188, 118, 255, 0.5); margin: 0; font-size: var(--font-size-xl);">Estadísticas de <span id="stats-player-name" style="font-weight: var(--font-weight-bold);">Invocador</span></h2>
        <div class="stats-subtitle" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-top: var(--spacing-xs);">
          <span id="stats-match-type">Partida Normal</span> - <span id="stats-game-time" style="color: var(--omashu-active, #7747ea); text-shadow: 0 0 5px rgba(119, 71, 234, 0.3);">00:00</span>
          <span style="font-size: var(--font-size-xs); padding: 2px 8px; background: linear-gradient(to right, #6d3dff, #7747ea); border-radius: var(--border-radius-round); animation: pulse 2s infinite; margin-left: var(--spacing-sm); box-shadow: 0 0 12px rgba(109, 61, 255, 0.5);">EN VIVO</span>
        </div>
      </div>
    </div>
  </div>
    
  <div class="stats-sections layout-column" style="gap: var(--spacing-md);">
    <!-- Sección de KDA Detallado -->
    <div class="stats-section" style="background: linear-gradient(180deg, rgba(39, 22, 100, 0.8), rgba(19, 11, 55, 0.8)); border-radius: var(--border-radius-md); overflow: hidden; box-shadow: var(--shadow-md); border: 1px solid rgba(109, 61, 255, 0.15);">
      <div class="stats-section-header" style="padding: var(--spacing-sm) var(--spacing-md); border-bottom: 1px solid rgba(109, 61, 255, 0.15); background: rgba(109, 61, 255, 0.1);">
        <h3 style="font-size: var(--font-size-md); color: var(--omashu-purple-light, #bc76ff); text-shadow: 0 0 5px rgba(188, 118, 255, 0.3); margin: 0; font-weight: var(--font-weight-bold); text-transform: uppercase; letter-spacing: 0.5px;">Desempeño en Combate</h3>
      </div>
      <div class="stats-section-content" style="padding: var(--spacing-md);">
        <div class="stats-kda-container" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--spacing-md);">
          <div class="stats-kda-card" style="background: rgba(19, 11, 55, 0.5); padding: var(--spacing-md); border-radius: var(--border-radius-md); text-align: center; display: flex; flex-direction: column; gap: var(--spacing-xs); transition: transform 0.2s ease; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
            <div id="stats-kills" class="stats-kda-value" style="font-size: var(--font-size-xxl); font-weight: var(--font-weight-bold); color: var(--positive-color, #4caf50); text-shadow: 0 0 8px rgba(76, 175, 80, 0.5);">0</div>
            <div class="stats-kda-label" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); text-transform: uppercase; letter-spacing: 0.5px;">Eliminaciones</div>
        </div>
          <div class="stats-kda-card" style="background: rgba(19, 11, 55, 0.5); padding: var(--spacing-md); border-radius: var(--border-radius-md); text-align: center; display: flex; flex-direction: column; gap: var(--spacing-xs); transition: transform 0.2s ease; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
            <div id="stats-deaths" class="stats-kda-value" style="font-size: var(--font-size-xxl); font-weight: var(--font-weight-bold); color: var(--negative-color, #f44336); text-shadow: 0 0 8px rgba(244, 67, 54, 0.5);">0</div>
            <div class="stats-kda-label" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); text-transform: uppercase; letter-spacing: 0.5px;">Muertes</div>
      </div>
          <div class="stats-kda-card" style="background: rgba(19, 11, 55, 0.5); padding: var(--spacing-md); border-radius: var(--border-radius-md); text-align: center; display: flex; flex-direction: column; gap: var(--spacing-xs); transition: transform 0.2s ease; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
            <div id="stats-assists" class="stats-kda-value" style="font-size: var(--font-size-xxl); font-weight: var(--font-weight-bold); color: var(--info-color, #29b6f6); text-shadow: 0 0 8px rgba(41, 182, 246, 0.5);">0</div>
            <div class="stats-kda-label" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); text-transform: uppercase; letter-spacing: 0.5px;">Asistencias</div>
        </div>
          <div class="stats-kda-card" style="background: rgba(19, 11, 55, 0.5); padding: var(--spacing-md); border-radius: var(--border-radius-md); text-align: center; display: flex; flex-direction: column; gap: var(--spacing-xs); transition: transform 0.2s ease; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
            <div id="stats-kda-ratio" class="stats-kda-value" style="font-size: var(--font-size-xxl); font-weight: var(--font-weight-bold); color: var(--omashu-purple-light, #bc76ff); text-shadow: 0 0 8px rgba(188, 118, 255, 0.5);">0.0</div>
            <div class="stats-kda-label" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); text-transform: uppercase; letter-spacing: 0.5px;">Ratio KDA</div>
      </div>
        </div>
      </div>
    </div>
    
    <!-- Sección de Recursos -->
    <div class="stats-section" style="background: linear-gradient(180deg, rgba(39, 22, 100, 0.8), rgba(19, 11, 55, 0.8)); border-radius: var(--border-radius-md); overflow: hidden; box-shadow: var(--shadow-md); border: 1px solid rgba(109, 61, 255, 0.15); margin-top: var(--spacing-md);">
      <div class="stats-section-header" style="padding: var(--spacing-sm) var(--spacing-md); border-bottom: 1px solid rgba(109, 61, 255, 0.15); background: rgba(109, 61, 255, 0.1);">
        <h3 style="font-size: var(--font-size-md); color: var(--omashu-purple-light, #bc76ff); text-shadow: 0 0 5px rgba(188, 118, 255, 0.3); margin: 0; font-weight: var(--font-weight-bold); text-transform: uppercase; letter-spacing: 0.5px;">Recursos y Economía</h3>
      </div>
      <div class="stats-section-content" style="padding: var(--spacing-md);">
        <div class="stats-metrics-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--spacing-md);">
          
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(255, 193, 7, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(255, 193, 7, 0.2), rgba(255, 193, 7, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(255, 193, 7, 0.3);">
              <img src="../../img/gold-icon.svg" alt="Oro" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(255, 193, 7, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Oro Total</div>
              <div id="stats-gold" class="stats-metric-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #FFC107; text-shadow: 0 0 8px rgba(255, 193, 7, 0.5);">0</div>
            </div>
          </div>
        
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(76, 175, 80, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(76, 175, 80, 0.3);">
              <img src="../../img/cs-icon.svg" alt="CS" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(76, 175, 80, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">CS Total</div>
              <div id="stats-cs" class="stats-metric-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #4CAF50; text-shadow: 0 0 8px rgba(76, 175, 80, 0.5);">0</div>
            </div>
          </div>
        
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(76, 175, 80, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(76, 175, 80, 0.3);">
              <img src="../../img/cs-per-min-icon.svg" alt="CS por minuto" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(76, 175, 80, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">CS por Minuto</div>
              <div id="stats-cs-per-min" class="stats-metric-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #4CAF50; text-shadow: 0 0 8px rgba(76, 175, 80, 0.5);">0.0</div>
            </div>
          </div>
        
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(109, 61, 255, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(109, 61, 255, 0.2), rgba(109, 61, 255, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(109, 61, 255, 0.3);">
              <img src="../../img/ward-icon.svg" alt="Wards" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(109, 61, 255, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Wards Colocados</div>
              <div id="stats-wards-placed" class="stats-metric-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: var(--omashu-purple-light, #bc76ff); text-shadow: 0 0 8px rgba(188, 118, 255, 0.5);">0</div>
            </div>
          </div>
          
          <!-- NUEVO: Wards Destruidos -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(255, 87, 34, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(255, 87, 34, 0.2), rgba(255, 87, 34, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(255, 87, 34, 0.3);">
              <img src="../../img/ward-destroyed-icon.svg" alt="Wards Destruidos" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(255, 87, 34, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Wards Destruidos</div>
              <div id="stats-wards-destroyed" class="stats-metric-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #FF5722; text-shadow: 0 0 8px rgba(255, 87, 34, 0.5);">0</div>
            </div>
          </div>
          
          <!-- NUEVO: Double Kills -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(255, 193, 7, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(255, 193, 7, 0.2), rgba(255, 193, 7, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(255, 193, 7, 0.3);">
               <img src="../../img/multikill-icon.svg" alt="Multi Kills" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(255, 193, 7, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Bajas Dobles</div>
              <div id="stats-double-kills" class="stats-metric-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #FFC107; text-shadow: 0 0 8px rgba(255, 193, 7, 0.5);">0</div>
            </div>
          </div>
          
        </div>
      </div>
    </div>
    
    <!-- Sección de Daño -->
    <div class="stats-section" style="background: linear-gradient(180deg, rgba(39, 22, 100, 0.8), rgba(19, 11, 55, 0.8)); border-radius: var(--border-radius-md); overflow: hidden; box-shadow: var(--shadow-md); border: 1px solid rgba(109, 61, 255, 0.15); margin-top: var(--spacing-md);">
      <div class="stats-section-header" style="padding: var(--spacing-sm) var(--spacing-md); border-bottom: 1px solid rgba(109, 61, 255, 0.15); background: rgba(109, 61, 255, 0.1);">
        <h3 style="font-size: var(--font-size-md); color: var(--omashu-purple-light, #bc76ff); text-shadow: 0 0 5px rgba(188, 118, 255, 0.3); margin: 0; font-weight: var(--font-weight-bold); text-transform: uppercase; letter-spacing: 0.5px;">Análisis de Daño</h3>
      </div>
      <div class="stats-section-content" style="padding: var(--spacing-md);">
        <div class="stats-metrics-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--spacing-md);">
          
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(233, 30, 99, 0.8);">
            <div class="stats-metric-icon damage-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(233, 30, 99, 0.2), rgba(233, 30, 99, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(233, 30, 99, 0.3);">
              <img src="../../img/damage-icon.svg" alt="Daño" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(233, 30, 99, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Daño Total</div>
              <div id="stats-total-damage" class="stats-metric-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #E91E63; text-shadow: 0 0 8px rgba(233, 30, 99, 0.5);">0</div>
            </div>
          </div>
        
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(244, 67, 54, 0.8);">
            <div class="stats-metric-icon damage-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(244, 67, 54, 0.2), rgba(244, 67, 54, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(244, 67, 54, 0.3);">
              <img src="../../img/champion-damage-icon.svg" alt="Daño a campeones" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(244, 67, 54, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Daño a Campeones</div>
              <div id="stats-champion-damage" class="stats-metric-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #F44336; text-shadow: 0 0 8px rgba(244, 67, 54, 0.5);">0</div>
            </div>
          </div>
        
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(76, 175, 80, 0.8);">
            <div class="stats-metric-icon heal-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(76, 175, 80, 0.3);">
              <img src="../../img/healing-icon.svg" alt="Curación" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(76, 175, 80, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Curación Total</div>
              <div id="stats-total-healing" class="stats-metric-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #4CAF50; text-shadow: 0 0 8px rgba(76, 175, 80, 0.5);">0</div>
            </div>
          </div>
        
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(255, 152, 0, 0.8);">
            <div class="stats-metric-icon damage-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(255, 152, 0, 0.2), rgba(255, 152, 0, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(255, 152, 0, 0.3);">
              <img src="../../img/damage-taken-icon.svg" alt="Daño recibido" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(255, 152, 0, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Daño Recibido</div>
              <div id="stats-damage-taken" class="stats-metric-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #FF9800; text-shadow: 0 0 8px rgba(255, 152, 0, 0.5);">0</div>
            </div>
          </div>
            
          <!-- NUEVO: Daño Auto-Mitigado -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(3, 169, 244, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(3, 169, 244, 0.2), rgba(3, 169, 244, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(3, 169, 244, 0.3);">
              <img src="../../img/shield-icon.svg" alt="Daño Mitigado" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(3, 169, 244, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Daño Mitigado</div>
              <div id="stats-damage-self-mitigated" class="stats-metric-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #03A9F4; text-shadow: 0 0 8px rgba(3, 169, 244, 0.5);">0</div>
            </div>
          </div>
          
          <!-- NUEVO: Daño a Objetivos -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(156, 39, 176, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(156, 39, 176, 0.2), rgba(156, 39, 176, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(156, 39, 176, 0.3);">
              <img src="../../img/objective-damage-icon.svg" alt="Daño a Objetivos" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(156, 39, 176, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Daño a Objetivos</div>
              <div id="stats-objective-damage" class="stats-metric-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #9C27B0; text-shadow: 0 0 8px rgba(156, 39, 176, 0.5);">0</div>
            </div>
          </div>
          
          <!-- NUEVO: Daño a Edificios -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(156, 39, 176, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(156, 39, 176, 0.2), rgba(156, 39, 176, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(156, 39, 176, 0.3);">
              <img src="../../img/building-damage-icon.svg" alt="Daño a Edificios" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(156, 39, 176, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Daño a Edificios</div>
              <div id="stats-building-damage" class="stats-metric-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #9C27B0; text-shadow: 0 0 8px rgba(156, 39, 176, 0.5);">0</div>
            </div>
          </div>
          
        </div>
      </div>
    </div>
    
    <!-- NUEVA SECCIÓN: Estadísticas del Campeón -->
    <div class="stats-section" style="background: linear-gradient(180deg, rgba(39, 22, 100, 0.8), rgba(19, 11, 55, 0.8)); border-radius: var(--border-radius-md); overflow: hidden; box-shadow: var(--shadow-md); border: 1px solid rgba(109, 61, 255, 0.15); margin-top: var(--spacing-md);">
      <div class="stats-section-header" style="padding: var(--spacing-sm) var(--spacing-md); border-bottom: 1px solid rgba(109, 61, 255, 0.15); background: rgba(109, 61, 255, 0.1);">
        <h3 style="font-size: var(--font-size-md); color: var(--omashu-purple-light, #bc76ff); text-shadow: 0 0 5px rgba(188, 118, 255, 0.3); margin: 0; font-weight: var(--font-weight-bold); text-transform: uppercase; letter-spacing: 0.5px;">Estadísticas del Campeón</h3>
      </div>
      <div class="stats-section-content" style="padding: var(--spacing-md);">
        <div class="stats-metrics-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--spacing-md);">
          <!-- Vida Actual / Máxima -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(76, 175, 80, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(76, 175, 80, 0.3);">
              <img src="../../img/health-icon.svg" alt="Vida" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(76, 175, 80, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Vida</div>
              <div id="stats-champ-health" class="stats-metric-value health-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">0 / 0</div>
            </div>
          </div>
          <!-- Poder de Habilidad (AP) -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(33, 150, 243, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(33, 150, 243, 0.2), rgba(33, 150, 243, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(33, 150, 243, 0.3);">
              <img src="../../img/ap-icon.svg" alt="AP" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(33, 150, 243, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Poder Habilidad</div>
              <div id="stats-champ-ap" class="stats-metric-value ap-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">0</div>
            </div>
          </div>
          <!-- Daño de Ataque (AD) -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(255, 152, 0, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(255, 152, 0, 0.2), rgba(255, 152, 0, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(255, 152, 0, 0.3);">
              <img src="../../img/ad-icon.svg" alt="AD" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(255, 152, 0, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Daño Ataque</div>
              <div id="stats-champ-ad" class="stats-metric-value ad-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">0</div>
            </div>
          </div>
          <!-- Velocidad de Ataque -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(255, 235, 59, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(255, 235, 59, 0.2), rgba(255, 235, 59, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(255, 235, 59, 0.3);">
              <img src="../../img/as-icon.svg" alt="AS" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(255, 235, 59, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Vel. Ataque</div>
              <div id="stats-champ-as" class="stats-metric-value as-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">0.00</div>
            </div>
          </div>
          <!-- Armadura -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(158, 158, 158, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(158, 158, 158, 0.2), rgba(158, 158, 158, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(158, 158, 158, 0.3);">
              <img src="../../img/armor-icon.svg" alt="Armadura" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(158, 158, 158, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Armadura</div>
              <div id="stats-champ-armor" class="stats-metric-value armor-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">0</div>
            </div>
          </div>
          <!-- Resistencia Mágica -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(156, 39, 176, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(156, 39, 176, 0.2), rgba(156, 39, 176, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(156, 39, 176, 0.3);">
              <img src="../../img/mr-icon.svg" alt="MR" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(156, 39, 176, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Res. Mágica</div>
              <div id="stats-champ-mr" class="stats-metric-value mr-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">0</div>
            </div>
          </div>
          <!-- Probabilidad de Crítico -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(244, 67, 54, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(244, 67, 54, 0.2), rgba(244, 67, 54, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(244, 67, 54, 0.3);">
              <img src="../../img/crit-icon.svg" alt="Crit" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(244, 67, 54, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Prob. Crítico</div>
              <div id="stats-champ-crit" class="stats-metric-value crit-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">0%</div>
            </div>
          </div>
          <!-- Velocidad de Movimiento -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(76, 175, 80, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(76, 175, 80, 0.3);">
              <img src="../../img/ms-icon.svg" alt="MS" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(76, 175, 80, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Vel. Movimiento</div>
              <div id="stats-champ-ms" class="stats-metric-value ms-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">0</div>
            </div>
          </div>
          <!-- Tenacidad -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(121, 85, 72, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(121, 85, 72, 0.2), rgba(121, 85, 72, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(121, 85, 72, 0.3);">
              <img src="../../img/tenacity-icon.svg" alt="Tenacidad" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(121, 85, 72, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Tenacidad</div>
              <div id="stats-champ-tenacity" class="stats-metric-value tenacity-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">0%</div>
            </div>
          </div>
          <!-- Robo de Vida -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(233, 30, 99, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(233, 30, 99, 0.2), rgba(233, 30, 99, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(233, 30, 99, 0.3);">
              <img src="../../img/lifesteal-icon.svg" alt="Robo Vida" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(233, 30, 99, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Robo de Vida</div>
              <div id="stats-champ-lifesteal" class="stats-metric-value lifesteal-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">0%</div>
            </div>
          </div>
          <!-- Omnivamp -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(103, 58, 183, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(103, 58, 183, 0.2), rgba(103, 58, 183, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(103, 58, 183, 0.3);">
              <img src="../../img/omnivamp-icon.svg" alt="Omnivamp" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(103, 58, 183, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Omnivamp</div>
              <div id="stats-champ-omnivamp" class="stats-metric-value omnivamp-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">0%</div>
            </div>
          </div>
          <!-- NUEVO: Aceleración de Habilidad -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(0, 188, 212, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(0, 188, 212, 0.2), rgba(0, 188, 212, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(0, 188, 212, 0.3);">
              <img src="../../img/ability-haste-icon.svg" alt="AH" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(0, 188, 212, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Acel. Habilidad</div>
              <div id="stats-champ-ah" class="stats-metric-value ah-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #00BCD4;">0</div>
            </div>
          </div>
          <!-- NUEVO: Penetración de Armadura % -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(255, 87, 34, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(255, 87, 34, 0.2), rgba(255, 87, 34, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(255, 87, 34, 0.3);">
              <img src="../../img/armor-pen-icon.svg" alt="Pen Armor" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(255, 87, 34, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Pen. Armadura %</div>
              <div id="stats-champ-armor-pen-percent" class="stats-metric-value pen-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #FF5722;">0%</div>
            </div>
          </div>
          <!-- NUEVO: Penetración Mágica % -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(103, 58, 183, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(103, 58, 183, 0.2), rgba(103, 58, 183, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(103, 58, 183, 0.3);">
              <img src="../../img/magic-pen-icon.svg" alt="Pen Magia" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(103, 58, 183, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Pen. Mágica %</div>
              <div id="stats-champ-magic-pen-percent" class="stats-metric-value pen-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #673AB7;">0%</div>
            </div>
          </div>
          <!-- NUEVO: Letalidad Física -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(255, 87, 34, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(255, 87, 34, 0.2), rgba(255, 87, 34, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(255, 87, 34, 0.3);">
              <img src="../../img/lethality-icon.svg" alt="Letalidad" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(255, 87, 34, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Letalidad</div>
              <div id="stats-champ-lethality" class="stats-metric-value pen-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #FF5722;">0</div>
            </div>
          </div>
          <!-- NUEVO: Rango de Ataque -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(96, 125, 139, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(96, 125, 139, 0.2), rgba(96, 125, 139, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(96, 125, 139, 0.3);">
              <img src="../../img/attack-range-icon.svg" alt="Rango" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(96, 125, 139, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Rango Ataque</div>
              <div id="stats-champ-range" class="stats-metric-value range-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #607D8B;">0</div>
            </div>
          </div>
          <!-- NUEVO: Poder Curación/Escudo -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(139, 195, 74, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(139, 195, 74, 0.2), rgba(139, 195, 74, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(139, 195, 74, 0.3);">
              <img src="../../img/heal-shield-power-icon.svg" alt="Heal/Shield" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(139, 195, 74, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Poder Curación/Escudo</div>
              <div id="stats-champ-heal-shield" class="stats-metric-value heal-shield-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #8BC34A;">0%</div>
            </div>
          </div>
          
           <!-- NUEVO: Regeneración de Vida -->
           <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(76, 175, 80, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(76, 175, 80, 0.3);">
              <img src="../../img/hp-regen-icon.svg" alt="Regen Vida" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(76, 175, 80, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Regen. Vida (/5s)</div>
              <div id="stats-champ-health-regen" class="stats-metric-value health-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">0.0</div>
            </div>
          </div>
          
          <!-- NUEVO: Daño Crítico (%) -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(244, 67, 54, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(244, 67, 54, 0.2), rgba(244, 67, 54, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(244, 67, 54, 0.3);">
              <img src="../../img/crit-damage-icon.svg" alt="Crit DMG" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(244, 67, 54, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Daño Crítico</div>
              <div id="stats-champ-crit-damage" class="stats-metric-value crit-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">+0%</div>
            </div>
          </div>
          
          <!-- NUEVO: Penetración Armadura Plana -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(255, 87, 34, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(255, 87, 34, 0.2), rgba(255, 87, 34, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(255, 87, 34, 0.3);">
              <img src="../../img/armor-pen-flat-icon.svg" alt="Pen Armor Flat" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(255, 87, 34, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Pen. Armadura Plana</div>
              <div id="stats-champ-armor-pen-flat" class="stats-metric-value pen-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #FF5722;">0</div>
            </div>
          </div>
          
          <!-- NUEVO: Penetración Mágica Plana -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(103, 58, 183, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(103, 58, 183, 0.2), rgba(103, 58, 183, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(103, 58, 183, 0.3);">
              <img src="../../img/magic-pen-flat-icon.svg" alt="Pen Magic Flat" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(103, 58, 183, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Pen. Mágica Plana</div>
              <div id="stats-champ-magic-pen-flat" class="stats-metric-value pen-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #673AB7;">0</div>
            </div>
          </div>

          <!-- NUEVO: Vampirismo Físico -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(233, 30, 99, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(233, 30, 99, 0.2), rgba(233, 30, 99, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(233, 30, 99, 0.3);">
              <img src="../../img/physical-vamp-icon.svg" alt="Phys Vamp" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(233, 30, 99, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Vampirismo Físico</div>
              <div id="stats-champ-physical-vamp" class="stats-metric-value lifesteal-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">0%</div>
            </div>
          </div>

          <!-- NUEVO: Vampirismo de Hechizo -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(103, 58, 183, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(103, 58, 183, 0.2), rgba(103, 58, 183, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(103, 58, 183, 0.3);">
              <img src="../../img/spell-vamp-icon.svg" alt="Spell Vamp" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(103, 58, 183, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Vampirismo Hechizo</div>
              <div id="stats-champ-spell-vamp" class="stats-metric-value omnivamp-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold);">0%</div>
            </div>
          </div>

           <!-- NUEVO: Recurso (Actual/Max/Tipo) -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(3, 169, 244, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(3, 169, 244, 0.2), rgba(3, 169, 244, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(3, 169, 244, 0.3);">
              <img id="stats-champ-resource-icon" src="../../img/mana-icon.svg" alt="Recurso" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(3, 169, 244, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div id="stats-champ-resource-name" class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Maná</div>
              <div id="stats-champ-resource" class="stats-metric-value resource-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #03A9F4;">0 / 0</div>
            </div>
          </div>

          <!-- NUEVO: Regeneración de Recurso -->
          <div class="stats-metric" style="background: rgba(19, 11, 55, 0.4); border-radius: var(--border-radius-md); padding: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); transition: transform 0.2s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); border-left: 3px solid rgba(3, 169, 244, 0.8);">
            <div class="stats-metric-icon" style="width: 40px; height: 40px; background: linear-gradient(135deg, rgba(3, 169, 244, 0.2), rgba(3, 169, 244, 0.05)); border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: 0 0 10px rgba(3, 169, 244, 0.3);">
              <img id="stats-champ-resource-regen-icon" src="../../img/mana-regen-icon.svg" alt="Regen Recurso" style="width: 24px; height: 24px; filter: drop-shadow(0 0 3px rgba(3, 169, 244, 0.5));"/>
            </div>
            <div class="stats-metric-info" style="flex-grow: 1;">
              <div id="stats-champ-resource-regen-name" class="stats-metric-name" style="color: var(--text-secondary, rgba(255,255,255,0.65)); font-size: var(--font-size-sm); margin-bottom: 2px;">Regen. Maná (/5s)</div>
              <div id="stats-champ-resource-regen" class="stats-metric-value resource-value" style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: #03A9F4;">0.0</div>
            </div>
          </div>
         </div>
       </div>
    </div>
    
    <!-- NUEVA SECCIÓN: TABLA DE VARIABLES -->
    <div class="stats-section" style="background: linear-gradient(180deg, rgba(39, 22, 100, 0.8), rgba(19, 11, 55, 0.8)); border-radius: var(--border-radius-md); overflow: hidden; box-shadow: var(--shadow-md); border: 1px solid rgba(109, 61, 255, 0.15); margin-top: var(--spacing-md);">
      <div class="stats-section-header" style="padding: var(--spacing-sm) var(--spacing-md); border-bottom: 1px solid rgba(109, 61, 255, 0.15); background: rgba(109, 61, 255, 0.1); display: flex; justify-content: space-between; align-items: center;">
        <h3 style="font-size: var(--font-size-md); color: var(--omashu-purple-light, #bc76ff); text-shadow: 0 0 5px rgba(188, 118, 255, 0.3); margin: 0; font-weight: var(--font-weight-bold); text-transform: uppercase; letter-spacing: 0.5px;">Variables del Juego</h3>
        <div style="display: flex; gap: 10px;">
          <button id="btn-exportar-vars" style="background: linear-gradient(135deg, #2e7d32, #43a047); color: white; border: none; padding: 6px 12px; border-radius: var(--border-radius-sm); cursor: pointer; font-weight: var(--font-weight-bold); font-size: var(--font-size-sm); display: flex; align-items: center; gap: 5px; transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Exportar JSON
          </button>
        </div>
      </div>
      <div class="stats-section-content" style="padding: var(--spacing-md);">
        <div class="variables-wrapper" style="max-height: 400px; overflow-y: auto; background: rgba(13, 7, 35, 0.6); border-radius: var(--border-radius-md); border: 1px solid rgba(109, 61, 255, 0.1); box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.3);">
          <table id="tabla-variables" style="width: 100%; border-collapse: collapse; font-size: var(--font-size-sm);">
            <thead>
              <tr style="background: linear-gradient(90deg, rgba(39, 22, 100, 0.9), rgba(39, 22, 100, 0.7)); position: sticky; top: 0; z-index: 1; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);">
                <th style="padding: 10px 12px; text-align: left; color: var(--omashu-purple-light, #bc76ff); font-weight: var(--font-weight-bold); text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid rgba(109, 61, 255, 0.3);">Variable</th>
                <th style="padding: 10px 12px; text-align: left; color: var(--omashu-purple-light, #bc76ff); font-weight: var(--font-weight-bold); text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 2px solid rgba(109, 61, 255, 0.3);">Valor</th>
              </tr>
            </thead>
            <tbody id="variables-body" style="color: var(--text-primary, #fff);">
              <!-- Aquí se insertarán dinámicamente las variables -->
              <tr>
                <td colspan="2" style="text-align: center; padding: 30px; font-size: var(--font-size-md); color: var(--text-secondary, rgba(255,255,255,0.65));">
                  <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="opacity: 0.6;">
                      <circle cx="12" cy="12" r="10"></circle>
                      <line x1="12" y1="8" x2="12" y2="12"></line>
                      <line x1="12" y1="16" x2="12.01" y2="16"></line>
                    </svg>
                    Cargando variables...
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    
    <!-- CONTENEDOR ADICIONAL PARA DEBUG DE VARIABLES EN TEXTO PLANO -->
    <div id="plain-text-variables-debug" style="margin-top: var(--spacing-md); padding: var(--spacing-md); background: rgba(0,0,0,0.4); border-radius: var(--border-radius-md); border: 1px dashed #888; max-height: 300px; overflow-y: auto; font-family: monospace; font-size: 11px; color: #ccc; line-height: 1.4;">
      <h4 style="margin: 0 0 10px 0; color: #FF9800; border-bottom: 1px solid #555; padding-bottom: 5px;">DEBUG: Rutas de Variables (Texto Plano)</h4>
      <!-- Las rutas se insertarán aquí -->
    </div>

  </div>
</div>

<script>
(function() { // Inicio de IIFE

  // --- Funciones Locales ---
  // function formatGameTime(seconds) { ... } // Eliminada, usar window.parent.formatGameTime

  function formatNumber(num) {
    return new Intl.NumberFormat('es-ES').format(num ?? 0); // Añadir ?? 0 para seguridad
  }

  function calculateKDARatio(kills, deaths, assists) {
    const k = kills ?? 0;
    const d = deaths ?? 0;
    const a = assists ?? 0;
    if (d === 0) return ((k + a) > 0 ? "Perfect" : "0.0");
    return ((k + a) / d).toFixed(1);
  }
  
  let ultimosDatos = {};

  // Función principal para actualizar TODA la UI de la pestaña Stats
  function updateUI(gameData) {
    console.log("[tab-stats] updateUI llamada con datos:", gameData ? 'Presentes' : 'Ausentes');
    const data = gameData || {}; // Usar objeto vacío si no hay datos
    // Guardar copia profunda solo si es necesario para exportar
    // ultimosDatos = JSON.parse(JSON.stringify(data)); 
    
    // Optimización: Obtener todos los elementos una vez
    const uiElements = {
      playerName: document.getElementById('stats-player-name'),
      matchType: document.getElementById('stats-match-type'),
      gameTime: document.getElementById('stats-game-time'),
      kills: document.getElementById('stats-kills'),
      deaths: document.getElementById('stats-deaths'),
      assists: document.getElementById('stats-assists'),
      kdaRatio: document.getElementById('stats-kda-ratio'),
      gold: document.getElementById('stats-gold'),
      cs: document.getElementById('stats-cs'),
      csPerMin: document.getElementById('stats-cs-per-min'),
      wardsPlaced: document.getElementById('stats-wards-placed'),
      wardsDestroyed: document.getElementById('stats-wards-destroyed'),
      doubleKills: document.getElementById('stats-double-kills'),
      totalDamage: document.getElementById('stats-total-damage'), // Corresponde a damageDealt
      championDamage: document.getElementById('stats-champion-damage'), // Corresponde a damageDealtToChampions
      totalHealing: document.getElementById('stats-total-healing'), // Corresponde a healingDone
      damageTaken: document.getElementById('stats-damage-taken'),
      damageSelfMitigated: document.getElementById('stats-damage-self-mitigated'),
      objectiveDamage: document.getElementById('stats-objective-damage'), // Corresponde a damageToObjectives
      buildingDamage: document.getElementById('stats-building-damage'), // Corresponde a damageToBuildings
      tbody: document.getElementById('variables-body'),
      plainTextOutput: document.getElementById('plain-text-variables-debug'),
      // Nuevos elementos championStats
      champHealth: document.getElementById('stats-champ-health'),
      champAP: document.getElementById('stats-champ-ap'),
      champAD: document.getElementById('stats-champ-ad'),
      champAS: document.getElementById('stats-champ-as'),
      champArmor: document.getElementById('stats-champ-armor'),
      champMR: document.getElementById('stats-champ-mr'),
      champCrit: document.getElementById('stats-champ-crit'),
      champMS: document.getElementById('stats-champ-ms'),
      champTenacity: document.getElementById('stats-champ-tenacity'),
      champLifesteal: document.getElementById('stats-champ-lifesteal'),
      champOmnivamp: document.getElementById('stats-champ-omnivamp'),
      champAH: document.getElementById('stats-champ-ah'),
      champArmorPenPercent: document.getElementById('stats-champ-armor-pen-percent'),
      champMagicPenPercent: document.getElementById('stats-champ-magic-pen-percent'),
      champLethality: document.getElementById('stats-champ-lethality'),
      champRange: document.getElementById('stats-champ-range'),
      champHealShield: document.getElementById('stats-champ-heal-shield'),
      // Añadir más si se implementaron (CritDamage, Vamp, Regen, Recursos...)
      champCritDamage: document.getElementById('stats-champ-crit-damage'), // Asumiendo que se añade este ID
      champPhysicalVamp: document.getElementById('stats-champ-physical-vamp'), // Asumiendo que se añade este ID
      champHealthRegen: document.getElementById('stats-champ-health-regen') // Asumiendo que se añade este ID
    };

    // Función helper para actualizar texto si existe el elemento y el dato
    const updateText = (element, value, formatter = formatNumber) => {
      if (element && value !== undefined && value !== null) {
        element.textContent = formatter(value);
      } else if (element) {
        element.textContent = formatter(0); // O mostrar '-' o mantener el valor anterior?
      }
    };

    // --- Actualizar Encabezado ---
    updateText(uiElements.playerName, data.summoner?.name, val => val || "Invocador");
    updateText(uiElements.matchType, data.match?.gameMode, val => val || "Partida");
    updateText(uiElements.gameTime, data.match?.gameTime, window.parent?.formatGameTime ?? (secs => "::"));

    // --- Actualizar KDA ---
    const kills = data.match?.kills;
    const deaths = data.match?.deaths;
    const assists = data.match?.assists;
    updateText(uiElements.kills, kills);
    updateText(uiElements.deaths, deaths);
    updateText(uiElements.assists, assists);
    updateText(uiElements.kdaRatio, calculateKDARatio(kills, deaths, assists), val => val); // KDA Ratio no usa formatNumber

    // --- Actualizar Recursos ---
    updateText(uiElements.gold, data.match?.gold);
    const cs = data.match?.cs;
    updateText(uiElements.cs, cs);
    if (uiElements.csPerMin && data.match?.gameTime > 0 && cs !== undefined) {
      const csPerMinute = (cs / (data.match.gameTime / 60)).toFixed(1);
      uiElements.csPerMin.textContent = csPerMinute;
    } else if (uiElements.csPerMin) {
      uiElements.csPerMin.textContent = "0.0";
    }
    updateText(uiElements.wardsPlaced, data.vision?.wardsPlaced);
    updateText(uiElements.wardsDestroyed, data.vision?.wardsDestroyed);
    updateText(uiElements.doubleKills, data.match?.doubleKills);

    // --- Actualizar Daño y Curación --- 
    updateText(uiElements.totalDamage, data.combat?.damageDealt);
    updateText(uiElements.championDamage, data.combat?.damageDealtToChampions);
    updateText(uiElements.totalHealing, data.combat?.healingDone);
    updateText(uiElements.damageTaken, data.combat?.damageTaken);
    updateText(uiElements.damageSelfMitigated, data.combat?.damageSelfMitigated);
    updateText(uiElements.objectiveDamage, data.combat?.damageToObjectives);
    updateText(uiElements.buildingDamage, data.combat?.damageToBuildings);

    // --- Actualizar Estadísticas del Campeón ---
    const champStats = data.championStats;
    if (uiElements.champHealth && champStats?.currentHealth !== undefined && champStats?.maxHealth !== undefined) {
        uiElements.champHealth.textContent = `${formatNumber(champStats.currentHealth)} / ${formatNumber(champStats.maxHealth)}`;
    }
    updateText(uiElements.champAP, champStats?.abilityPower);
    updateText(uiElements.champAD, champStats?.attackDamage);
    updateText(uiElements.champAS, champStats?.attackSpeed, val => (val ?? 0).toFixed(2)); // Formato AS
    updateText(uiElements.champArmor, champStats?.armor);
    updateText(uiElements.champMR, champStats?.magicResist);
    updateText(uiElements.champCrit, champStats?.critChance, val => `${formatNumber((val ?? 0) * 100)}%`); // Formato % Crit
    updateText(uiElements.champMS, champStats?.moveSpeed);
    updateText(uiElements.champTenacity, champStats?.tenacity, val => `${formatNumber((val ?? 0) * 100)}%`); // Formato % Tenacidad
    updateText(uiElements.champLifesteal, champStats?.lifeSteal, val => `${formatNumber((val ?? 0) * 100)}%`); // Formato % Robo Vida
    updateText(uiElements.champOmnivamp, champStats?.omnivamp, val => `${formatNumber((val ?? 0) * 100)}%`); // Formato % Omnivamp

    // --- Actualizar Nuevas Estadísticas del Campeón ---
    updateText(uiElements.champAH, champStats?.abilityHaste);
    // Usar 'bonusArmorPenetrationPercent' o 'armorPenetrationPercent' - verificar cuál se usa
    updateText(uiElements.champArmorPenPercent, champStats?.bonusArmorPenetrationPercent ?? champStats?.armorPenetrationPercent, val => `${formatNumber((val ?? 0) * 100)}%`);
    // Usar 'bonusMagicPenetrationPercent' o 'magicPenetrationPercent'
    updateText(uiElements.champMagicPenPercent, champStats?.bonusMagicPenetrationPercent ?? champStats?.magicPenetrationPercent, val => `${formatNumber((val ?? 0) * 100)}%`);
    updateText(uiElements.champLethality, champStats?.physicalLethality);
    updateText(uiElements.champRange, champStats?.attackRange);
    updateText(uiElements.champHealShield, champStats?.healShieldPower, val => `${formatNumber((val ?? 0) * 100)}%`);

    // --- Actualizar Tabla de Variables y Debug --- 
    // (Solo si la pestaña está activa para optimizar? O si los datos cambiaron significativamente?)
    if (uiElements.tbody) actualizarTablaHTML(uiElements.tbody, data);
    if (uiElements.plainTextOutput) actualizarDebugTextoPlano(uiElements.plainTextOutput, data);
  }

  // Función auxiliar para generar filas de la tabla HTML
  function actualizarTablaHTML(tbody, gameData) {
    if (!tbody) return;
    tbody.innerHTML = ''; // Limpiar tabla
    let rowCount = 0;

    function generateTableRows(obj, prefix = '') {
        if (!obj || typeof obj !== 'object' || rowCount >= 100) return;
        // Añadimos un chequeo extra para evitar iterar sobre arrays grandes o muy anidados
        if (Array.isArray(obj) && obj.length > 20) { // Limitar arrays grandes
            console.warn(`[TableGen] Array grande (${prefix || 'root'}) omitido para renderizado.`);
          return;
        }
        if (prefix.split('.').length > 6) { // Limitar profundidad
            console.warn(`[TableGen] Profundidad excesiva (${prefix}) omitida.`);
          return;
        }
        
        const keys = Object.keys(obj).sort();
        for (const key of keys) {
            if (rowCount >= 100) break;
            const value = obj[key];
            const fullName = prefix ? `${prefix}.${key}` : key;

            // Omitir ciertas claves internas o muy largas
            if (key === 'listeners' || key === 'events') continue; 
            if (fullName.length > 80) continue; 

            const row = document.createElement('tr');
            row.style.borderBottom = '1px solid #333';

            const nameCell = document.createElement('td');
            nameCell.style.padding = '6px';
            nameCell.style.fontWeight = 'bold';
            nameCell.style.wordBreak = 'break-all'; // Para nombres largos
            nameCell.textContent = fullName;

            const valueCell = document.createElement('td');
            valueCell.style.padding = '6px';
            valueCell.style.wordBreak = 'break-all'; // Para valores largos

            if (value === null) {
                valueCell.textContent = 'null';
                valueCell.style.color = '#888';
            } else if (value === undefined) {
                valueCell.textContent = 'undefined';
                valueCell.style.color = '#888';
            } else if (typeof value === 'object') {
                if (Array.isArray(value)) {
                    // Mostrar solo longitud si es array
                    valueCell.textContent = `Array[${value.length}]`;
                    valueCell.style.color = '#5F9EA0';
                    // No expandir arrays en la tabla por simplicidad
            } else {
                    // Mostrar tipo objeto y número de props
                    valueCell.textContent = `Object{${Object.keys(value).length} props}`;
                    valueCell.style.color = '#7B68EE';
                    // Llamada recursiva para objetos anidados
                    generateTableRows(value, fullName);
            }
          } else {
                valueCell.textContent = String(value).substring(0, 100); // Limitar longitud string
                 if (String(value).length > 100) valueCell.textContent += '...';
                if (typeof value === 'boolean') {
                    valueCell.style.color = value ? '#4CAF50' : '#F44336';
                } else if (typeof value === 'number') {
                    valueCell.style.color = '#03A9F4';
                }
            }

            row.appendChild(nameCell);
            row.appendChild(valueCell);
            tbody.appendChild(row);
            rowCount++;
        }
    }

    try {
        generateTableRows(gameData);
    } catch (e) {
        console.error("[TableGen] Error generando filas:", e);
        tbody.innerHTML = `<tr><td colspan="2" style="color: red;">Error al generar tabla: ${e.message}</td></tr>`;
    }

    if (rowCount === 0) {
        tbody.innerHTML = '<tr><td colspan="2" style="text-align: center; padding: 20px;">Esperando datos...</td></tr>';
    }
  }

  // Función auxiliar para actualizar el debug de texto plano
  function actualizarDebugTextoPlano(outputElement, gameData) {
      if (!outputElement) return;
      const titleElement = outputElement.querySelector('h4');
      outputElement.innerHTML = ''; // Limpiar contenido anterior
      if (titleElement) outputElement.appendChild(titleElement); // Restaurar título

      let paths = [];
      function findPaths(obj, currentPath = '') {
          if (!obj || typeof obj !== 'object' || currentPath.split('.').length > 6) return; // Limitar profundidad
          Object.keys(obj).forEach(key => {
              const newPath = currentPath ? `${currentPath}.${key}` : key;
              // Omitir claves internas/largas también aquí
               if (key === 'listeners' || key === 'events' || newPath.length > 80) return;
              paths.push(newPath);
              if (typeof obj[key] === 'object' && !Array.isArray(obj[key])) {
                  findPaths(obj[key], newPath);
              } else if (Array.isArray(obj[key]) && obj[key].length > 0 && typeof obj[key][0] === 'object') {
                  findPaths(obj[key][0], `${newPath}[0]`);
              }
          });
      }
      try {
          findPaths(gameData);
          paths.sort();
          const pre = document.createElement('pre');
          pre.textContent = paths.join('\n');
          outputElement.appendChild(pre);
      } catch (e) {
          console.error("[DebugText] Error generando rutas:", e);
          outputElement.innerHTML += `<div style="color:red">Error: ${e.message}</div>`;
      }
  }
  
  // --- Lógica de Exportación (sin cambios) --- 
    const btnExportar = document.getElementById('btn-exportar-vars');
  if (btnExportar) {
      btnExportar.addEventListener('click', () => {
          try {
      const jsonStr = JSON.stringify(ultimosDatos, null, 2);
              const blob = new Blob([jsonStr], {type: 'application/json'});
              const url = URL.createObjectURL(blob);
              const a = document.createElement('a');
              a.href = url;
              a.download = `stats-data-${new Date().toISOString().replace(/:/g, '-')}.json`; // Nombre de archivo mejorado
              document.body.appendChild(a);
              a.click();
              document.body.removeChild(a);
              URL.revokeObjectURL(url);
          } catch (e) { console.error("Error exportando JSON:", e); }
      });
  } else { console.warn("Botón de exportar no encontrado"); }

  // --- INICIALIZACIÓN Y SUSCRIPCIÓN ---
  console.log("[tab-stats] Script cargado y ejecutándose.");
  try {
    if (window.parent && typeof window.parent.subscribeToGameData === 'function') {
      console.log("[tab-stats] Suscribiendo a gameDataManager...");
      window.parent.subscribeToGameData(updateUI);
         } else {
      console.error("[tab-stats] No se pudo encontrar window.parent.subscribeToGameData.");
    }

    if (window.parent && typeof window.parent.getGameData === 'function') {
      const initialData = window.parent.getGameData();
      console.log("[tab-stats] Aplicando datos iniciales:", initialData);
      updateUI(initialData);
          } else {
      console.error("[tab-stats] No se pudo encontrar window.parent.getGameData.");
      updateUI(null); // Pasar null explícitamente si no hay datos
    }
  } catch (error) {
    console.error("[tab-stats] Error durante inicialización/suscripción:", error);
  }

})(); // Fin de IIFE

</script>

<!-- Estilos movidos fuera y después del script -->
<style>
  @keyframes pulse {
    0% { opacity: 1; }
    50% { opacity: 0.7; }
    100% { opacity: 1; }
  }
  
  .stats-kda-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
  }
  /* Estilos para filas de la tabla de variables */
  #tabla-variables tbody tr {
    border-bottom: 1px solid rgba(109, 61, 255, 0.1);
    transition: background-color 0.2s ease;
  }
  
  #tabla-variables tbody tr:hover {
    background-color: rgba(109, 61, 255, 0.1);
  }
  
  /* Estilos para el botón de exportar */
  #btn-exportar-vars:hover {
    background: linear-gradient(135deg, #43a047, #66bb6a);
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
  }
  
  #btn-exportar-vars:active {
    transform: translateY(0px);
  }
  
  /* Estilos para la barra de desplazamiento */
  .variables-wrapper::-webkit-scrollbar {
    width: 8px;
  }
  
  .variables-wrapper::-webkit-scrollbar-track {
    background: rgba(13, 7, 35, 0.3);
    border-radius: 4px;
  }
  
  .variables-wrapper::-webkit-scrollbar-thumb {
    background: rgba(109, 61, 255, 0.3);
    border-radius: 4px;
  }
  
  .variables-wrapper::-webkit-scrollbar-thumb:hover {
    background: rgba(109, 61, 255, 0.5);
  }
  
  /* Efectos hover para métricas */
  .stats-metric:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
  }

  /* Estilos para tags de valor */
  .valor-tag {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 3px 8px;
    border-radius: 4px;
    border: 1px solid transparent;
    font-size: var(--font-size-xs);
  }

  .valor-tag svg {
    stroke: currentColor;
    stroke-width: 2;
    fill: none;
    stroke-linecap: round;
    stroke-linejoin: round;
    opacity: 0.8;
  }

  .valor-array {
    background: rgba(95, 158, 160, 0.1);
    color: #5F9EA0;
    border-color: rgba(95, 158, 160, 0.2);
  }

  .valor-object {
    background: rgba(123, 104, 238, 0.1);
    color: #7B68EE;
    border-color: rgba(123, 104, 238, 0.2);
  }

  .valor-boolean {
    /* Estilos ya definidos inline por simplicidad */
  }

  .valor-number {
    background: rgba(3, 169, 244, 0.1);
    color: #03A9F4;
    border-color: rgba(3, 169, 244, 0.2);
  }

  .valor-string {
    background: rgba(255, 255, 255, 0.08);
    color: white;
    border-color: rgba(255, 255, 255, 0.15);
  }
  
  /* ANIMACIONES ADICIONALES */
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .stats-metric-value, .stats-kda-value {
    animation: fadeInUp 0.5s ease-out;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  
  .stats-section {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  
  .stats-section:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
  }

  .stats-header::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, 
      rgba(109, 61, 255, 0) 0%, 
      rgba(109, 61, 255, 0.05) 50%, 
      rgba(109, 61, 255, 0) 100%);
    animation: shimmer 3s infinite;
  }

  @keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
  }

  /* Estilos para stats de campeón compactas */
  .stats-metric.compact {
    flex-direction: row;
    padding: var(--spacing-xs);
    gap: var(--spacing-xs);
  }

  .stats-metric.compact .stats-metric-icon {
    width: 28px;
    height: 28px;
  }

  .stats-metric.compact .stats-metric-icon img {
     width: 18px;
     height: 18px;
  }

  .stats-metric.compact .stats-metric-info {
    text-align: left;
  }

  .stats-metric.compact .stats-metric-name {
    font-size: var(--font-size-xs);
    margin-bottom: 0;
  }

  .stats-metric.compact .stats-metric-value {
    font-size: var(--font-size-md);
    text-shadow: none;
  }

  /* Colores específicos para champion stats */
  .health-value { color: var(--positive-color, #4caf50); }
  .ap-value { color: #2196F3; } /* Azul */
  .ad-value { color: #FF9800; } /* Naranja */
  .as-value { color: #FFEB3B; } /* Amarillo */
  .armor-value { color: #9E9E9E; } /* Gris */
  .mr-value { color: #9C27B0; } /* Púrpura */
  .crit-value { color: #f44336; } /* Rojo */
  .ms-value { color: #4CAF50; } /* Verde */
  .tenacity-value { color: #795548; } /* Marrón */
  .lifesteal-value { color: #E91E63; } /* Rosa */
  .omnivamp-value { color: #673AB7; } /* Púrpura Oscuro */
  .ah-value { color: #00BCD4; } /* Cyan */
  .pen-value { color: #FF5722; } /* Naranja Oscuro */
  .range-value { color: #607D8B; } /* Azul Grisáceo */
  .heal-shield-value { color: #8BC34A; } /* Verde Lima */
  /* Color para recurso */
  .resource-value { color: #03A9F4; }
</style> 